{"version":3,"file":"admin-contactos.js","sources":["../../src/scripts/admin-contactos.ts"],"sourcesContent":["import { apiGet, apiPut, getErrorInfo, toErrorText } from \"../lib/api\";\r\nimport { makeToaster } from \"../lib/admin-uploader\";\r\n\r\ntype ContactItem = any;\r\ntype EbillingItem = any;\r\n\r\nfunction debounce<T extends (...args: any[]) => void>(fn: T, ms = 300) {\r\n  let t: number | undefined;\r\n  return (...args: Parameters<T>) => {\r\n    if (t) window.clearTimeout(t);\r\n    t = window.setTimeout(() => fn(...args), ms);\r\n  };\r\n}\r\n\r\nconst badge = (s: string) => {\r\n  const map: Record<string, string> = { pending: \"is-pending\", resolved: \"is-resolved\" };\r\n  const label = s === \"resolved\" ? \"Resuelto\" : \"Pendiente\";\r\n  return `<span class=\"badge ${map[s] || \"is-pending\"}\">${label}</span>`;\r\n};\r\n\r\nconst fullName = (n?: string, a?: string) => (n || \"\") + (a ? \" \" + a : \"\");\r\n\r\nconst escapeHtml = (str: string) =>\r\n  (str || \"\").replace(/[&<>\\\"']/g, (m) =>\r\n    ({ \"&\": \"&amp;\", \"<\": \"&lt;\", \">\": \"&gt;\", '\"': \"&quot;\", \"'\": \"&#039;\" } as Record<string, string>)[m]\r\n  );\r\n\r\nfunction qsFrom(obj: Record<string, string | undefined>) {\r\n  const qs = new URLSearchParams();\r\n  for (const [k, v] of Object.entries(obj)) {\r\n    if (v != null && String(v).length) qs.set(k, String(v));\r\n  }\r\n  return qs.toString();\r\n}\r\n\r\nfunction must<T extends HTMLElement>(id: string) {\r\n  const el = document.getElementById(id) as T | null;\r\n  if (!el) throw new Error(`No se encontró #${id}`);\r\n  return el;\r\n}\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", () => {\r\n  const toast = makeToaster(\"status\", { okMs: 1600, errMs: 5000 });\r\n\r\n  let cPage = 1,\r\n    cPageSize = 10,\r\n    cTotal = 0;\r\n\r\n  let cItems: ContactItem[] = [];\r\n  let cQ = \"\",\r\n    cCat = \"\",\r\n    cStatus = \"\";\r\n\r\n  const cRows = must<HTMLTableSectionElement>(\"c-rows\");\r\n  const cInfo = must<HTMLSpanElement>(\"c-info\");\r\n  const cPrev = must<HTMLButtonElement>(\"c-prev\");\r\n  const cNext = must<HTMLButtonElement>(\"c-next\");\r\n  const cQEl = must<HTMLInputElement>(\"c-q\");\r\n  const cCatEl = must<HTMLSelectElement>(\"c-cat\");\r\n  const cStatusEl = must<HTMLSelectElement>(\"c-status\");\r\n\r\n  const contactModal = must<HTMLDialogElement>(\"contactModal\");\r\n  const contactDetail = must<HTMLDivElement>(\"contactDetail\");\r\n  const closeContactModal = must<HTMLButtonElement>(\"closeContactModal\");\r\n\r\n  let ePage = 1,\r\n    ePageSize = 10,\r\n    eTotal = 0;\r\n\r\n  let eItems: EbillingItem[] = [];\r\n  let eQ = \"\",\r\n    eStatus = \"\";\r\n\r\n  const eRows = must<HTMLTableSectionElement>(\"e-rows\");\r\n  const eInfo = must<HTMLSpanElement>(\"e-info\");\r\n  const ePrev = must<HTMLButtonElement>(\"e-prev\");\r\n  const eNext = must<HTMLButtonElement>(\"e-next\");\r\n  const eQEl = must<HTMLInputElement>(\"e-q\");\r\n  const eStatusEl = must<HTMLSelectElement>(\"e-status\");\r\n\r\n  const ebillingModal = must<HTMLDialogElement>(\"ebillingModal\");\r\n  const ebillingDetail = must<HTMLDivElement>(\"ebillingDetail\");\r\n  const closeEbillingModal = must<HTMLButtonElement>(\"closeEbillingModal\");\r\n\r\n  function renderContactRow(c: any) {\r\n    const nombre = fullName(c.nombre, c.apellido);\r\n    const cat = c.categoria || \"—\";\r\n    const email = c.email || \"—\";\r\n    const tel = c.telefono || \"—\";\r\n    const st = c.status || \"pending\";\r\n    const handled = c.handledByUserId != null ? `#${c.handledByUserId}` : \"—\";\r\n\r\n    const actions =\r\n      st === \"pending\"\r\n        ? `<button class=\"kbtn success solid c-resolve\" data-id=\"${c.id}\">Resolver</button>`\r\n        : `<button class=\"kbtn ghost c-reopen\" data-id=\"${c.id}\">Reabrir</button>`;\r\n\r\n    return `<tr>\r\n      <td>${escapeHtml(nombre || \"—\")}</td>\r\n      <td class=\"hidem\">${escapeHtml(cat)}</td>\r\n      <td class=\"hidem\">${escapeHtml(email)}</td>\r\n      <td class=\"hidem\">${escapeHtml(tel)}</td>\r\n      <td class=\"hidem\">${badge(st)}</td>\r\n      <td class=\"hidem\">${escapeHtml(handled)}</td>\r\n      <td class=\"td actions\">\r\n        <div class=\"row-actions\">\r\n          <button class=\"kbtn c-view\" data-id=\"${c.id}\">Ver</button>\r\n          ${actions}\r\n        </div>\r\n      </td>\r\n    </tr>`;\r\n  }\r\n\r\n  function openContactModalById(id: string) {\r\n    const c = cItems.find((x: any) => String(x.id) === String(id));\r\n    if (!c) return;\r\n\r\n    const rows: Array<[string, any]> = [\r\n      [\"Nombre\", fullName(c.nombre, c.apellido) || \"—\"],\r\n      [\"Categoría\", c.categoria || \"—\"],\r\n      [\"Email\", c.email || \"—\"],\r\n      [\"Teléfono\", c.telefono || \"—\"],\r\n      [\"Socio Nº\", c.socioNumero ?? \"—\"],\r\n      [\"DNI\", c.dni ?? \"—\"],\r\n      [\"Estado\", c.status === \"resolved\" ? \"Resuelto\" : \"Pendiente\"],\r\n      [\"Resuelto por\", c.handledByUserId != null ? `#${c.handledByUserId}` : \"—\"],\r\n      [\"Detalle\", c.detalle || \"—\"],\r\n    ];\r\n\r\n    contactDetail.innerHTML = rows\r\n      .map(\r\n        ([k, v]) =>\r\n          `<div class=\"row\"><b>${escapeHtml(k)}</b><div>${escapeHtml(String(v))}</div></div>`\r\n      )\r\n      .join(\"\");\r\n\r\n    contactModal.showModal();\r\n  }\r\n\r\n  async function onContactStatus(id: string, status: \"pending\" | \"resolved\") {\r\n    const ok = confirm(status === \"resolved\" ? \"¿Marcar como resuelto?\" : \"¿Reabrir contacto?\");\r\n    if (!ok) return;\r\n\r\n    try {\r\n      toast.show(\"Actualizando…\");\r\n      const r = await apiPut(`/v1/contacts/${encodeURIComponent(id)}/status`, { status });\r\n      if (!r.ok) {\r\n        const { text } = await getErrorInfo(r);\r\n        return toast.show(text || \"No se pudo actualizar\", \"err\");\r\n      }\r\n      await loadContacts();\r\n      toast.show(\"Actualizado ✅\", \"ok\");\r\n    } catch (err) {\r\n      console.error(err);\r\n      toast.show(toErrorText(err) || \"No se pudo actualizar\", \"err\");\r\n    }\r\n  }\r\n\r\n  async function loadContacts() {\r\n    try {\r\n      cRows.innerHTML = `<tr><td colspan=\"7\" class=\"empty\">Cargando…</td></tr>`;\r\n\r\n      const qs = qsFrom({\r\n        page: String(cPage),\r\n        pageSize: String(cPageSize),\r\n        q: cQ || undefined,\r\n        categoria: cCat || undefined,\r\n        status: cStatus || undefined,\r\n      });\r\n\r\n      const res = await apiGet(`/v1/contacts?${qs}`);\r\n      if (!res.ok) throw new Error(await res.text());\r\n      const data = await res.json();\r\n\r\n      cTotal = data.total || 0;\r\n      cItems = Array.isArray(data.items) ? data.items : [];\r\n\r\n      if (!cItems.length) {\r\n        cRows.innerHTML = `<tr><td colspan=\"7\" class=\"empty\">Sin resultados</td></tr>`;\r\n      } else {\r\n        cRows.innerHTML = cItems.map(renderContactRow).join(\"\");\r\n\r\n        cRows.querySelectorAll<HTMLButtonElement>(\".c-view\").forEach((btn) =>\r\n          btn.addEventListener(\"click\", () => openContactModalById(btn.dataset.id || \"\"))\r\n        );\r\n        cRows.querySelectorAll<HTMLButtonElement>(\".c-resolve\").forEach((btn) =>\r\n          btn.addEventListener(\"click\", () => onContactStatus(btn.dataset.id || \"\", \"resolved\"))\r\n        );\r\n        cRows.querySelectorAll<HTMLButtonElement>(\".c-reopen\").forEach((btn) =>\r\n          btn.addEventListener(\"click\", () => onContactStatus(btn.dataset.id || \"\", \"pending\"))\r\n        );\r\n      }\r\n\r\n      const maxPage = Math.max(1, Math.ceil(cTotal / cPageSize));\r\n      const first = cTotal ? (cPage - 1) * cPageSize + 1 : 0;\r\n      const last = Math.min(cPage * cPageSize, cTotal);\r\n\r\n      cInfo.textContent = cTotal ? `${first}-${last} de ${cTotal}` : \"0 resultados\";\r\n\r\n      const prevDisabled = cPage <= 1;\r\n      const nextDisabled = cPage >= maxPage;\r\n\r\n      cPrev.disabled = prevDisabled;\r\n      cNext.disabled = nextDisabled;\r\n      cPrev.setAttribute(\"aria-disabled\", String(prevDisabled));\r\n      cNext.setAttribute(\"aria-disabled\", String(nextDisabled));\r\n    } catch (e) {\r\n      console.error(e);\r\n      cRows.innerHTML = `<tr><td colspan=\"7\" class=\"empty\">Error cargando</td></tr>`;\r\n      toast.show(\"Error cargando contactos\", \"err\");\r\n    }\r\n  }\r\n\r\n  function renderEbillingRow(r: any) {\r\n    const nombre = fullName(r.nombre, r.apellido);\r\n    const st = r.status || \"pending\";\r\n\r\n    const actions =\r\n      st === \"pending\"\r\n        ? `<button class=\"kbtn success solid e-resolve\" data-id=\"${r.id}\">Resolver</button>`\r\n        : `<button class=\"kbtn ghost e-reopen\" data-id=\"${r.id}\">Reabrir</button>`;\r\n\r\n    return `<tr>\r\n      <td>${escapeHtml(String(r.abonadoNumero ?? \"—\"))}</td>\r\n      <td>${escapeHtml(nombre || \"—\")}</td>\r\n      <td class=\"hidem\">${escapeHtml(String(r.dniCuit ?? \"—\"))}</td>\r\n      <td class=\"hidem\">${escapeHtml(r.email || \"—\")}</td>\r\n      <td class=\"hidem\">${escapeHtml(r.telefono || \"—\")}</td>\r\n      <td class=\"hidem\">${badge(st)}</td>\r\n      <td class=\"td actions\">\r\n        <div class=\"row-actions\">\r\n          <button class=\"kbtn e-view\" data-id=\"${r.id}\">Ver</button>\r\n          ${actions}\r\n        </div>\r\n      </td>\r\n    </tr>`;\r\n  }\r\n\r\n  function openEbillingModalById(id: string) {\r\n    const r = eItems.find((x: any) => String(x.id) === String(id));\r\n    if (!r) return;\r\n\r\n    const rows: Array<[string, any]> = [\r\n      [\"Abonado Nº\", r.abonadoNumero ?? \"—\"],\r\n      [\"DNI/CUIT\", r.dniCuit ?? \"—\"],\r\n      [\"Nombre\", fullName(r.nombre, r.apellido) || \"—\"],\r\n      [\"Email\", r.email || \"—\"],\r\n      [\"Teléfono\", r.telefono || \"—\"],\r\n      [\"Estado\", r.status === \"resolved\" ? \"Resuelto\" : \"Pendiente\"],\r\n    ];\r\n\r\n    ebillingDetail.innerHTML = rows\r\n      .map(\r\n        ([k, v]) =>\r\n          `<div class=\"row\"><b>${escapeHtml(k)}</b><div>${escapeHtml(String(v))}</div></div>`\r\n      )\r\n      .join(\"\");\r\n\r\n    ebillingModal.showModal();\r\n  }\r\n\r\n  async function onEbillingStatus(id: string, status: \"pending\" | \"resolved\") {\r\n    const ok = confirm(status === \"resolved\" ? \"¿Marcar como resuelto?\" : \"¿Reabrir solicitud?\");\r\n    if (!ok) return;\r\n\r\n    try {\r\n      toast.show(\"Actualizando…\");\r\n      const r = await apiPut(`/v1/ebilling-requests/${encodeURIComponent(id)}/status`, { status });\r\n      if (!r.ok) {\r\n        const { text } = await getErrorInfo(r);\r\n        return toast.show(text || \"No se pudo actualizar\", \"err\");\r\n      }\r\n      await loadEbilling();\r\n      toast.show(\"Actualizado ✅\", \"ok\");\r\n    } catch (err) {\r\n      console.error(err);\r\n      toast.show(toErrorText(err) || \"No se pudo actualizar\", \"err\");\r\n    }\r\n  }\r\n\r\n  async function loadEbilling() {\r\n    try {\r\n      eRows.innerHTML = `<tr><td colspan=\"7\" class=\"empty\">Cargando…</td></tr>`;\r\n\r\n      const qs = qsFrom({\r\n        page: String(ePage),\r\n        pageSize: String(ePageSize),\r\n        q: eQ || undefined,\r\n        status: eStatus || undefined,\r\n      });\r\n\r\n      const res = await apiGet(`/v1/ebilling-requests?${qs}`);\r\n      if (!res.ok) throw new Error(await res.text());\r\n      const data = await res.json();\r\n\r\n      eTotal = data.total || 0;\r\n      eItems = Array.isArray(data.items) ? data.items : [];\r\n\r\n      if (!eItems.length) {\r\n        eRows.innerHTML = `<tr><td colspan=\"7\" class=\"empty\">Sin resultados</td></tr>`;\r\n      } else {\r\n        eRows.innerHTML = eItems.map(renderEbillingRow).join(\"\");\r\n\r\n        eRows.querySelectorAll<HTMLButtonElement>(\".e-view\").forEach((btn) =>\r\n          btn.addEventListener(\"click\", () => openEbillingModalById(btn.dataset.id || \"\"))\r\n        );\r\n        eRows.querySelectorAll<HTMLButtonElement>(\".e-resolve\").forEach((btn) =>\r\n          btn.addEventListener(\"click\", () => onEbillingStatus(btn.dataset.id || \"\", \"resolved\"))\r\n        );\r\n        eRows.querySelectorAll<HTMLButtonElement>(\".e-reopen\").forEach((btn) =>\r\n          btn.addEventListener(\"click\", () => onEbillingStatus(btn.dataset.id || \"\", \"pending\"))\r\n        );\r\n      }\r\n\r\n      const maxPage = Math.max(1, Math.ceil(eTotal / ePageSize));\r\n      const first = eTotal ? (ePage - 1) * ePageSize + 1 : 0;\r\n      const last = Math.min(ePage * ePageSize, eTotal);\r\n\r\n      eInfo.textContent = eTotal ? `${first}-${last} de ${eTotal}` : \"0 resultados\";\r\n\r\n      const prevDisabled = ePage <= 1;\r\n      const nextDisabled = ePage >= maxPage;\r\n\r\n      ePrev.disabled = prevDisabled;\r\n      eNext.disabled = nextDisabled;\r\n      ePrev.setAttribute(\"aria-disabled\", String(prevDisabled));\r\n      eNext.setAttribute(\"aria-disabled\", String(nextDisabled));\r\n    } catch (e) {\r\n      console.error(e);\r\n      eRows.innerHTML = `<tr><td colspan=\"7\" class=\"empty\">Error cargando</td></tr>`;\r\n      toast.show(\"Error cargando adhesiones\", \"err\");\r\n    }\r\n  }\r\n\r\n  cQEl.addEventListener(\r\n    \"input\",\r\n    debounce(() => {\r\n      cQ = (cQEl.value || \"\").trim();\r\n      cPage = 1;\r\n      loadContacts();\r\n    }, 300)\r\n  );\r\n\r\n  cCatEl.addEventListener(\"change\", () => {\r\n    cCat = cCatEl.value || \"\";\r\n    cPage = 1;\r\n    loadContacts();\r\n  });\r\n\r\n  cStatusEl.addEventListener(\"change\", () => {\r\n    cStatus = cStatusEl.value || \"\";\r\n    cPage = 1;\r\n    loadContacts();\r\n  });\r\n\r\n  cPrev.addEventListener(\"click\", () => {\r\n    if (cPage > 1) {\r\n      cPage--;\r\n      loadContacts();\r\n    }\r\n  });\r\n\r\n  cNext.addEventListener(\"click\", () => {\r\n    const maxPage = Math.max(1, Math.ceil(cTotal / cPageSize));\r\n    if (cPage < maxPage) {\r\n      cPage++;\r\n      loadContacts();\r\n    }\r\n  });\r\n\r\n  eQEl.addEventListener(\r\n    \"input\",\r\n    debounce(() => {\r\n      eQ = (eQEl.value || \"\").trim();\r\n      ePage = 1;\r\n      loadEbilling();\r\n    }, 300)\r\n  );\r\n\r\n  eStatusEl.addEventListener(\"change\", () => {\r\n    eStatus = eStatusEl.value || \"\";\r\n    ePage = 1;\r\n    loadEbilling();\r\n  });\r\n\r\n  ePrev.addEventListener(\"click\", () => {\r\n    if (ePage > 1) {\r\n      ePage--;\r\n      loadEbilling();\r\n    }\r\n  });\r\n\r\n  eNext.addEventListener(\"click\", () => {\r\n    const maxPage = Math.max(1, Math.ceil(eTotal / ePageSize));\r\n    if (ePage < maxPage) {\r\n      ePage++;\r\n      loadEbilling();\r\n    }\r\n  });\r\n\r\n  contactModal.addEventListener(\"click\", (e) => {\r\n    if (e.target === contactModal) contactModal.close();\r\n  });\r\n  ebillingModal.addEventListener(\"click\", (e) => {\r\n    if (e.target === ebillingModal) ebillingModal.close();\r\n  });\r\n\r\n  closeContactModal.addEventListener(\"click\", () => contactModal.close());\r\n  closeEbillingModal.addEventListener(\"click\", () => ebillingModal.close());\r\n\r\n  loadContacts();\r\n  loadEbilling();\r\n});\r\n"],"names":["debounce","fn","ms","t","args","badge","s","map","label","fullName","n","a","escapeHtml","str","m","qsFrom","obj","qs","k","v","must","id","el","toast","makeToaster","cPage","cPageSize","cTotal","cItems","cQ","cCat","cStatus","cRows","cInfo","cPrev","cNext","cQEl","cCatEl","cStatusEl","contactModal","contactDetail","closeContactModal","ePage","ePageSize","eTotal","eItems","eQ","eStatus","eRows","eInfo","ePrev","eNext","eQEl","eStatusEl","ebillingModal","ebillingDetail","closeEbillingModal","renderContactRow","c","nombre","cat","email","tel","st","handled","actions","openContactModalById","x","rows","onContactStatus","status","r","apiPut","text","getErrorInfo","loadContacts","err","toErrorText","res","apiGet","data","btn","maxPage","first","last","prevDisabled","nextDisabled","e","renderEbillingRow","openEbillingModalById","onEbillingStatus","loadEbilling"],"mappings":"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"}