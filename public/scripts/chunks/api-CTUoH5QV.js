function u(e){const t=document.cookie?document.cookie.split("; "):[];for(const r of t){const n=r.indexOf("=");if((n>-1?r.slice(0,n):r)===e)return decodeURIComponent(n>-1?r.slice(n+1):"")}return null}function g(e,t){document.cookie=`${e}=${encodeURIComponent(t)}; Path=/; SameSite=Lax`}let f=null;async function y(){const e=await fetch("/v1/auth/refresh",{method:"POST",credentials:"include"});if(!e.ok)return null;const t=await e.json().catch(()=>null),r=t==null?void 0:t.token;return r?(g("access_token",r),r):null}function k(){return f||(f=y().finally(()=>{f=null})),f}const d={email:"Email",password:"Contraseña",tipo:"Tipo de publicación",titulo:"Título",excerpt:"Resumen",portadaUrl:"URL de la portada",linkUrl:"Enlace externo",destacado:"Destacado",blocksJson:"Contenido",estado:"Estado",slug:"Slug"};function p(e){if(!e)return"Campo";const t=e.split(".").pop();return d[t]?d[t]:t.replace(/([A-Z])/g," $1").replace(/_/g," ").trim().replace(/\burl\b/i,"URL").replace(/^\w/,n=>n.toUpperCase())}function A(e){if(!e)return"Error desconocido";if(typeof e=="string")return e;if(e instanceof Error)return e.message||"Error";try{const t=typeof e=="object"?e:JSON.parse(String(e));if(t!=null&&t.error){const r=t.error.message||"Error",n=Array.isArray(t.error.details)?t.error.details[0]:null;if(n){const o=n.field||(Array.isArray(n.path)?n.path.at(-1):""),s=p(o);return`${n.message||r}: ${s}`}return r}return t!=null&&t.message?t.message:JSON.stringify(t)}catch{return String(e)}}async function E(e){let t=`Error ${e.status}`;const r=[];try{const n=await e.json(),o=(n==null?void 0:n.error)??n,s=(o==null?void 0:o.message)||t;if(Array.isArray(o==null?void 0:o.details)&&o.details.length){for(const i of o.details){const c=i.field||(Array.isArray(i.path)?i.path.at(-1):""),h=p(c),m=i.message||s||"Dato inválido";r.push({field:c,label:h,message:m})}const a=r[0];t=`${a.message}: ${a.label}`}else typeof s=="string"&&(t=s)}catch{}return{text:t,fieldErrors:r}}async function w(e){const{text:t}=await E(e);return t}async function l(e,t={}){const r=new Headers(t.headers||{});!(typeof FormData<"u"&&t.body instanceof FormData)&&t.body!=null&&!r.has("Content-Type")&&r.set("Content-Type","application/json");const o=u("access_token");o&&!r.has("Authorization")&&r.set("Authorization",`Bearer ${o}`);const s=u("csrf");s&&!r.has("x-csrf-token")&&r.set("x-csrf-token",s);let a=await fetch(e,{...t,headers:r,credentials:t.credentials??"include"});if(a.status!==401||e.startsWith("/v1/auth/"))return a;const i=await k();if(!i)return a;const c=new Headers(r);return c.set("Authorization",`Bearer ${i}`),fetch(e,{...t,headers:c,credentials:t.credentials??"include"})}const T=(e,t={})=>l(e,{...t,method:"GET"}),S=(e,t,r={})=>l(e,{...r,method:"POST",body:t instanceof FormData?t:t!=null?JSON.stringify(t):void 0}),x=(e,t,r={})=>l(e,{...r,method:"PUT",body:t instanceof FormData?t:t!=null?JSON.stringify(t):void 0}),C=(e,t,r={})=>l(e,{...r,method:"PATCH",body:t instanceof FormData?t:t!=null?JSON.stringify(t):void 0}),F=(e,t={})=>l(e,{...t,method:"DELETE"});async function D(e){if(!e.ok)throw new Error(await w(e));const t=await e.text();return t?JSON.parse(t):{}}export{S as a,T as b,x as c,C as d,F as e,l as f,E as g,D as j,A as t};
//# sourceMappingURL=api-CTUoH5QV.js.map
